<h1>GreenMachine Report</h1>

<% if @date_error %>
  <%= @error %>
  <%= link_to('Return to Default', '/green-machine') %>
<% elsif @error %>
  <%= @error %>
<% else %>
  <p>Period: <%= params[:start] %> to <%= params[:finish] %></p>

  <% unless @report.warnings.empty? %>
    <div class="warnings">
      <strong>Warnings</strong>
      <ul>
        <% @report.warnings.each do |w| %>
          <li><%= w %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <h2>Revenue</h2>
  <%= render('grid', grid_type: :revenue) %>

  <h2>Wages</h2>
  <%= render('grid', grid_type: :wage) %>

  <h2>Summary</h2>
  <%= render('summary_grid') %>

<% end %>

<%= @customers.entries.inspect if @customers %>

<!-- somewhere in your document include the Javascript -->
<script type="text/javascript" src="https://appcenter.intuit.com/Content/IA/intuit.ipp.anywhere-1.3.2.js"></script>

<!-- configure the Intuit object: 'grantUrl' is a URL in your application which kicks off the flow, see below -->
<script>
intuit.ipp.anywhere.setup({menuProxy: '/path/to/blue-dot', grantUrl: '<%= gm_quickbooks_flow_start_url %>'});
</script>

<!-- this will display a button that the user clicks to start the flow -->
<ipp:connectToIntuit></ipp:connectToIntuit>